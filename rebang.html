<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äººæ°”æ¦œå•</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #000; /* èƒŒæ™¯æ”¹ä¸ºé»‘è‰² */
            color: #fff; /* æ–‡å­—é¢œè‰²æ”¹ä¸ºç™½è‰² */
        }
        .container {
            width: 100%;
            margin: 20px auto;
            background: #1a1a1a; /* å®¹å™¨èƒŒæ™¯æ”¹ä¸ºæ·±ç°è‰² */
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1); /* è°ƒæ•´é˜´å½±é¢œè‰² */
        }
        h1 {
            text-align: center;
            color: #fff; /* æ ‡é¢˜é¢œè‰²æ”¹ä¸ºç™½è‰² */
            font-size: 2em;
            margin-bottom: 20px;
        }
        .list-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .list {
            width: calc(23% - 20px);
            background: #262626; /* åˆ—è¡¨èƒŒæ™¯æ”¹ä¸ºæ·±ç°è‰² */
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.1); /* è°ƒæ•´é˜´å½±é¢œè‰² */
            margin-bottom: 20px;
        }
        .list h2 {
            text-align: center; /* æ ‡é¢˜å±…ä¸­å¯¹é½ */
            margin-bottom: 10px;
            color: #fff; /* å­æ ‡é¢˜é¢œè‰²æ”¹ä¸ºç™½è‰² */
            font-size: 1.2em;
            border-bottom: 2px solid #444; /* è¾¹æ¡†é¢œè‰²æ”¹ä¸ºæ·±ç°è‰² */
            padding-bottom: 5px;
        }
        .list-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #444; /* è¾¹æ¡†é¢œè‰²æ”¹ä¸ºæ·±ç°è‰² */
            transition: background-color 0.3s; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
            position: relative; /* ç”¨äºç»å¯¹å®šä½ */
        }
        .list-item:last-child {
            border-bottom: none;
        }
        .list-item span {
            font-weight: bold;
        }
        .list-item .index {
            margin-right: 10px;
            font-weight: bold;
            color: #ccc; /* ç´¢å¼•é¢œè‰²æ”¹ä¸ºæµ…ç°è‰² */
        }
        .list-item .name {
            flex: 1;
            font-size: 1em;
        }
        .list-item .change-positive {
            color: #d32f2f; /* ä¸Šæ¶¨é¢œè‰²æ”¹ä¸ºçº¢è‰² */
        }
        .list-item .change-negative {
            color: #388e3c; /* ä¸‹è·Œé¢œè‰²æ”¹ä¸ºç»¿è‰² */
        }
        .list-item .topic {
            font-size: 0.9em;
            color: #ccc; /* é¢˜æé¢œè‰²æ”¹ä¸ºæµ…ç°è‰² */
        }
        .list-item .popularity-tag {
            color: #d32f2f; /* çƒ­åº¦æ ‡ç­¾é¢œè‰²æ”¹ä¸ºçº¢è‰² */
        }
        .highlight {
            background-color: #444; /* é«˜äº®é¢œè‰² */
        }
        .hot-news-icon {
            margin-left: 5px;
            color: #ff5722; /* ç«ç„°å›¾æ ‡é¢œè‰² */
            cursor: pointer; /* é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºæ‰‹å‹ */
        }
        .hot-news-tooltip {
            display: none;
            position: absolute;
            top: -45px; /* è°ƒæ•´ä¸ºè´Ÿå€¼ï¼Œä½¿å…¶åœ¨ä¸Šæ–¹æ˜¾ç¤º */
            left: 0;
            background-color: #d32f2f;
            color: #fff;
            padding: 14px;
            border-radius: 4px;
            white-space: nowrap;
            z-index: 1001; /* æé«˜z-indexå€¼ï¼Œç¡®ä¿åœ¨å…¶ä»–å…ƒç´ ä¹‹ä¸Š */
        }
        .list-item:hover .hot-news-tooltip {
            display: block;
        }
        .analyse-tooltip {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: #388e3c;
            color: #fff;
            padding: 14px;
            border-radius: 4px;
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œ */
            max-width: 400px; /* æœ€å¤§å®½åº¦ */
            z-index: 1000;
            font-size: 0.9em; /* å­—ä½“å¤§å° */
        }
        .list-item:hover .analyse-tooltip {
            display: block;
        }
        .reason-tooltip {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: #388e3c;
            color: #fff;
            padding: 14px;
            border-radius: 4px;
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œ */
            max-width: 400px; /* æœ€å¤§å®½åº¦ */
            z-index: 1000;
            font-size: 0.9em; /* å­—ä½“å¤§å° */
        }
        .list-item:hover .reason-tooltip {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="list-container">
            <div class="list" id="aigupiao-list">
                <h2>ğŸ“ˆçˆ±è‚¡ç¥¨çƒ­æ¦œ</h2>
                <div id="aigupiao-items"></div>
            </div>
            <div class="list" id="tenjqka-list">
                <h2>ğŸ“ˆåŒèŠ±é¡ºçƒ­æ¦œ</h2>
                <div id="tenjqka-items"></div>
            </div>
            <div class="list" id="longhuvip-list">
                <h2>ğŸ“ˆå¼€ç›˜å•¦çƒ­æ¦œ</h2>
                <div id="longhuvip-items"></div>
            </div>
            <div class="list" id="ziainquant-list">
                <h2>ğŸ“ˆè‡ªåœ¨é‡åŒ–çƒ­æ¦œ</h2>
                <div id="ziainquant-items"></div>
            </div>
        </div>
    </div>

    <script>
        async function fetchData(url) {
            const response = await fetch(url);
            return await response.json();
        }

        function getTodayDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}${month}${day}`;
        }

        function renderAigupiao(data) {
            const items = data.data.slice(0, 50).map((stock, index) => {
                const code = stock.code.replace(/^sh|sz|bj/, ''); // å»æ‰å‰ç¼€
                return `
                    <div class="list-item" data-code="${code}">
                        <span class="index">${index + 1}.</span>
                        <span class="name">${code} ${stock.name}</span>
                        <span class="change ${parseFloat(stock.chg_pct) > 0 ? 'change-positive' : 'change-negative'}">${stock.last} (${stock.chg_pct}%)</span>
                        <span class="topic">${stock.theme_name}</span>
                    </div>
                `;
            }).join('');
            document.getElementById('aigupiao-items').innerHTML = items;
        }

        function renderLonghuvip(data) {
            const items = data.List.slice(0, 50).map((stock, index) => {
                const changeText = stock[3] > 0 ? `(<span class="change-positive">â†‘${stock[3]}</span>)` : stock[3] < 0 ? `(<span class="change-negative">â†“${-stock[3]}</span>)` : '(æ— å˜åŒ–)';
                return `
                    <div class="list-item" data-code="${stock[0]}">
                        <span class="index">${index + 1}.</span>
                        <span class="name">${stock[0]} ${stock[1]}</span>
                        <span class="change ${parseFloat(stock[2]) > 0 ? 'change-positive' : 'change-negative'}">${stock[2]}%</span>
                        <span class="topic">${changeText}</span>
                    </div>
                `;
            }).join('');
            document.getElementById('longhuvip-items').innerHTML = items;
        }

        function renderTenjqka(data) {
            const items = data.data.stock_list.slice(0, 50).map((stock, index) => {
                const hasHotNews = stock.topic?.title ? 'ğŸ”¥' : '';
                const hotNewsTooltip = stock.topic?.title ? `<span class="hot-news-tooltip" title="${stock.topic?.title}">${stock.topic?.title}</span>` : '';
                const analyseTooltip = stock.analyse ? `<span class="analyse-tooltip">${stock.analyse}</span>` : '';
                return `
                    <div class="list-item" data-code="${stock.code}">
                        <span class="index">${index + 1}.</span>
                        <span class="name">${stock.code} ${stock.name}${hasHotNews}</span>
                        <span class="change">${stock.tag?.popularity_tag ? `(<span class="popularity-tag">${stock.tag.popularity_tag}</span>)` : '(<span class="popularity-tag">æ— </span>)'}</span>
                        <span class="topic">${stock.tag?.concept_tag?.join(', ') || 'æš‚æ— é¢˜æä¿¡æ¯'}${hotNewsTooltip}</span>
                        ${analyseTooltip}
                    </div>
                `;
            }).join('');
            document.getElementById('tenjqka-items').innerHTML = items;
        }

        async function fetchReason(code) {
            const response = await fetch(`http://api.zizizaizai.com/open/stock/${code}`);
            const data = await response.json();
            return data.data.reason;
        }

        function renderZiainquant(data) {
            const items = data.data.slice(0, 50).map((stock, index) => {
                const rankDiff = stock.rank_diff;
                const rankDiffText = rankDiff > 0 ? `(<span class="change-positive">â†‘${rankDiff}</span>)` :
                           rankDiff < 0 ? `(<span class="change-negative">â†“${-rankDiff}</span>)` :
                           '(æ— å˜åŒ–)';
                return `
                    <div class="list-item" data-code="${stock.symbol_code}">
                        <span class="index">${index + 1}.</span>
                        <span class="name">${stock.symbol_code} ${stock.symbol_name}</span>
                        <span class="change ${parseFloat(stock.last_pct) > 0 ? 'change-positive' : 'change-negative'}">${stock.last_price} (${stock.last_pct}%)</span>
                        <span class="topic">æµé€š: ${stock.circulation_value}äº¿ ${rankDiffText}</span>
                        <span class="reason-tooltip" data-code="${stock.symbol_code}"></span>
                    </div>
                `;
            }).join('');
            document.getElementById('ziainquant-items').innerHTML = items;

            document.querySelectorAll('.list-item .reason-tooltip').forEach(async (tooltip) => {
                const code = tooltip.getAttribute('data-code');
                const reason = await fetchReason(code);
                tooltip.textContent = reason;
            });
        }

        function highlightStock(code) {
            document.querySelectorAll('.list-item').forEach(item => {
                if (item.getAttribute('data-code') === code) {
                    item.classList.add('highlight');
                } else {
                    item.classList.remove('highlight');
                }
            });
        }

        function setupHoverEvents() {
            document.querySelectorAll('.list-item').forEach(item => {
                item.addEventListener('mouseover', () => {
                    const code = item.getAttribute('data-code');
                    highlightStock(code);
                });
                item.addEventListener('mouseout', () => {
                    document.querySelectorAll('.list-item').forEach(item => {
                        item.classList.remove('highlight');
                    });
                });
            });
        }

        async function loadAllData() {
            const todayDate = getTodayDate(); // è·å–å½“å¤©æ—¥æœŸ
            const aigupiaoData = await fetchData('https://www.aigupiao.com/Quote/get_hot_stock_list?number=100'); // çˆ±è‚¡ç¥¨çƒ­æ¦œ
            const longhuvipData = await fetchData('https://apphq.longhuvip.com/w1/api/index.php?Order=1&a=GetHotPHB&st=60&apiv=w21&Type=1&c=StockBidYiDong&PhoneOSNew=1'); // å¼€ç›˜å•¦çƒ­æ¦œ
            const tenjqkaData = await fetchData('https://eq.10jqka.com.cn/open/api/hot_list/v1/hot_stock/a/hour/data.txt'); // åŒèŠ±é¡ºçƒ­æ¦œ
            const ziainquantData = await fetchData(`http://api.zizizaizai.com/open/sentiment/media/ths2/top?date1=${todayDate}&top_n=50`); // è‡ªåœ¨é‡åŒ–çƒ­æ¦œ

            renderAigupiao(aigupiaoData);
            renderLonghuvip(longhuvipData);
            renderTenjqka(tenjqkaData);
            renderZiainquant(ziainquantData); // æ¸²æŸ“è‡ªåœ¨é‡åŒ–çƒ­æ¦œ

            setupHoverEvents(); // è®¾ç½®é¼ æ ‡æ‚¬åœäº‹ä»¶
        }

        // åˆå§‹åŠ è½½æ•°æ®
        loadAllData();

        // æ¯5åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡æ•°æ®
        setInterval(loadAllData, 300000); // 300000æ¯«ç§’ = 5åˆ†é’Ÿ
    </script>
</body>
</html>